import { Link, useLocation } from "react-router";

const PAGE_NAME_MAP: Record<string, string> = {
    "": "概览",
    settings: "设置",
    analysis: "数据分析",
    profile: "个人主页管理",
    encrypt: "资源加解密与激活",
    manage: "资源管理",
    publish: "资源发布",
    "settings/github": "GitHub 选项",
};

export default function Header() {
    const location = useLocation();
    const pathname = location.pathname;

    const segments = pathname.replace(/^\//, "").split("/").filter(Boolean);

    const breadcrumbKeys: string[] = [];

    if (segments.length === 0) {
        breadcrumbKeys.push("");
    } else {
        let acc = "";
        segments.forEach((seg, index) => {
            acc = index === 0 ? seg : `${acc}/${seg}`;
            breadcrumbKeys.push(acc);
        });
    }

    return (
        <header className="flex flex-row gap-2.5 px-3.5 py-2 items-center">
            <CreatorConsoleLogo />

            {breadcrumbKeys.map((key, index) => {
                const label = PAGE_NAME_MAP[key] ?? key;
                const isLast = index === breadcrumbKeys.length - 1;
                const to = key === "" ? "/" : `/${key}`;

                return (
                    <div key={key} className="flex flex-row items-center gap-2">
                        <Slash />
                        <Link
                            to={to}
                            className={`font-[520] text-size-large ${isLast ? "" : "text-header-text-is-not-last"} rounded px-1 py-0.5 cursor-pointer transition-colors hover:bg-gray-100 dark:hover:bg-neutral-800`}
                        >
                            {label}
                        </Link>
                    </div>
                );
            })}
        </header>
    );
}

function Slash() {
    return (
        <svg
            xmlns="http://www.w3.org/2000/svg"
            width="8"
            height="12"
            viewBox="0 0 8 12"
            fill="none"
        >
            <path
                d="M7.9992 0L1.9008 11.916H0L6.0984 0H7.9992Z"
                fill="white"
                fill-opacity="0.3"
            />
        </svg>
    );
}

function CreatorConsoleLogo() {
    return (
        <svg
            xmlns="http://www.w3.org/2000/svg"
            width="132"
            height="13"
            viewBox="0 0 132 13"
            fill="none"
        >
            <path
                d="M6.15918 0.22168C7.00625 0.22168 7.79499 0.374808 8.52441 0.680664C9.25381 0.974775 9.88948 1.39246 10.4307 1.93359C10.9836 2.46304 11.407 3.07537 11.7012 3.76953L9.45996 4.59863C9.26001 4.16355 8.99526 3.78727 8.66602 3.46973C8.33659 3.1403 7.95967 2.88742 7.53613 2.71094C7.11256 2.52268 6.65335 2.42871 6.15918 2.42871C5.44172 2.42878 4.80093 2.61101 4.23633 2.97559C3.68333 3.32856 3.24737 3.81684 2.92969 4.44043C2.62385 5.06397 2.4707 5.78782 2.4707 6.61133C2.47074 7.43481 2.62963 8.16453 2.94727 8.7998C3.26494 9.42331 3.70678 9.91752 4.27148 10.2822C4.83616 10.6351 5.48356 10.8115 6.21289 10.8115C6.71855 10.8115 7.17724 10.7174 7.58887 10.5293C8.01244 10.3293 8.38349 10.058 8.70117 9.7168C9.03039 9.37575 9.29518 8.98197 9.49512 8.53516L11.7363 9.34668C11.4422 10.0643 11.0188 10.7 10.4658 11.2529C9.92462 11.8058 9.28898 12.2351 8.55957 12.541C7.83014 12.8469 7.03559 13 6.17676 13C4.97682 12.9999 3.91181 12.7296 2.98242 12.1885C2.05295 11.6355 1.3234 10.8817 0.793945 9.92871C0.264663 8.96408 4.38567e-05 7.85822 0 6.61133C0 5.36417 0.264499 4.26357 0.793945 3.31055C1.32336 2.34584 2.04723 1.59298 2.96484 1.05176C3.89425 0.49882 4.95922 0.221739 6.15918 0.22168ZM23.793 3.75195C24.5693 3.75204 25.2807 3.9584 25.9277 4.37012C26.5866 4.77016 27.1108 5.36404 27.499 6.15234C27.8989 6.92874 28.0986 7.87573 28.0986 8.99316H21.6318C21.661 9.3419 21.7627 9.65374 21.9395 9.92871C22.1629 10.2463 22.4451 10.4934 22.7861 10.6699C23.1391 10.8346 23.516 10.917 23.916 10.917C24.3984 10.917 24.7927 10.8172 25.0986 10.6172C25.4045 10.4054 25.64 10.135 25.8047 9.80566L27.8867 10.6172C27.6396 11.1113 27.316 11.5405 26.916 11.9053C26.5278 12.2582 26.0636 12.5295 25.5225 12.7178C24.9812 12.906 24.3631 13 23.6689 13C22.7985 13 22.0279 12.806 21.3574 12.418C20.6868 12.018 20.1568 11.4705 19.7686 10.7764C19.3921 10.0822 19.2041 9.28193 19.2041 8.37598C19.2041 7.47 19.3979 6.66977 19.7861 5.97559C20.1862 5.28142 20.7278 4.73983 21.4102 4.35156C22.1043 3.95167 22.8989 3.75195 23.793 3.75195ZM33.2246 3.75195C33.8754 3.75198 34.4589 3.89335 34.9746 4.17578C35.3149 4.35403 35.609 4.57853 35.8584 4.84766V3.93652H38.0879V12.8154H35.8584V11.9141C35.6131 12.1823 35.3195 12.4103 34.9746 12.5947C34.4589 12.8649 33.8754 13 33.2246 13C32.4141 13 31.6831 12.7969 31.0322 12.3916C30.3937 11.9864 29.8846 11.4396 29.5039 10.752C29.1355 10.052 28.9512 9.26637 28.9512 8.39453C28.9512 7.52261 29.1355 6.73612 29.5039 6.03613C29.8845 5.33645 30.3939 4.78406 31.0322 4.37891C31.6831 3.96137 32.4141 3.75195 33.2246 3.75195ZM42.7598 3.96387H44.9658V5.94043H42.7598V9.69922C42.7598 10.0757 42.8421 10.3644 43.0068 10.5645C43.1716 10.7526 43.4129 10.8467 43.7305 10.8467C43.848 10.8467 43.9772 10.8233 44.1182 10.7764C44.2593 10.7176 44.4067 10.6351 44.5596 10.5293L45.3721 12.2764C45.0898 12.4881 44.7718 12.6587 44.4189 12.7881C44.0777 12.9293 43.7357 13 43.3945 13C42.4182 12.9999 41.6768 12.7587 41.1709 12.2764C40.6768 11.794 40.4297 11.1051 40.4297 10.2109V5.94043H39V3.96387H40.4297V1.94629L42.7598 1.21094V3.96387ZM50.4492 3.75195C51.355 3.75195 52.1555 3.95166 52.8496 4.35156C53.5438 4.73983 54.0854 5.28141 54.4736 5.97559C54.8619 6.66977 55.0557 7.47 55.0557 8.37598C55.0557 9.28193 54.8619 10.0822 54.4736 10.7764C54.0854 11.4705 53.5438 12.0179 52.8496 12.418C52.1674 12.806 51.3792 12.9999 50.4854 13C49.5913 13 48.7908 12.8061 48.085 12.418C47.3908 12.018 46.8434 11.4705 46.4434 10.7764C46.0551 10.0822 45.8613 9.28193 45.8613 8.37598C45.8613 7.47 46.0551 6.66977 46.4434 5.97559C46.8316 5.28145 47.3732 4.73982 48.0674 4.35156C48.7614 3.95176 49.5554 3.75201 50.4492 3.75195ZM69.0508 0.22168C69.8979 0.221684 70.6865 0.374756 71.416 0.680664C72.1452 0.974723 72.7802 1.39263 73.3213 1.93359C73.8743 2.46306 74.2986 3.07534 74.5928 3.76953L72.3516 4.59863C72.1516 4.16336 71.886 3.78737 71.5566 3.46973C71.2273 3.1404 70.8511 2.88742 70.4277 2.71094C70.0042 2.52269 69.5449 2.42872 69.0508 2.42871C68.3331 2.42871 67.6917 2.61084 67.127 2.97559C66.574 3.32856 66.1389 3.8169 65.8213 4.44043C65.5154 5.064 65.3623 5.78775 65.3623 6.61133C65.3624 7.43481 65.5212 8.16453 65.8389 8.7998C66.1565 9.42322 66.5975 9.91756 67.1621 10.2822C67.7268 10.6352 68.3741 10.8115 69.1035 10.8115C69.6095 10.8115 70.0687 10.7176 70.4805 10.5293C70.904 10.3293 71.2741 10.058 71.5918 9.7168C71.9212 9.37565 72.1867 8.98216 72.3867 8.53516L74.6279 9.34668C74.3338 10.0644 73.9104 10.7 73.3574 11.2529C72.8162 11.8059 72.1806 12.2351 71.4512 12.541C70.7217 12.8469 69.9273 13 69.0684 13C67.8684 13 66.8035 12.7296 65.874 12.1885C64.9445 11.6355 64.215 10.8817 63.6855 9.92871C63.1562 8.96404 62.8916 7.8583 62.8916 6.61133C62.8916 5.36414 63.1561 4.26358 63.6855 3.31055C64.215 2.3458 64.9387 1.59297 65.8564 1.05176C66.7859 0.498777 67.8507 0.22168 69.0508 0.22168ZM79.9961 3.75195C80.9019 3.75195 81.7024 3.95164 82.3965 4.35156C83.0907 4.73984 83.6322 5.2814 84.0205 5.97559C84.4088 6.66977 84.6025 7.47001 84.6025 8.37598C84.6025 9.28191 84.4088 10.0822 84.0205 10.7764C83.6322 11.4705 83.0906 12.017 82.3965 12.417C81.7141 12.8053 80.9255 13 80.0312 13C79.1373 12.9999 78.3376 12.8052 77.6318 12.417C76.9377 12.017 76.3903 11.4704 75.9902 10.7764C75.602 10.0822 75.4082 9.28191 75.4082 8.37598C75.4082 7.47 75.602 6.66977 75.9902 5.97559C76.3785 5.28144 76.9201 4.73982 77.6143 4.35156C78.3082 3.95176 79.1022 3.752 79.9961 3.75195ZM99.4219 3.75195C100.048 3.75197 100.675 3.81985 101.302 3.9541C101.928 4.08836 102.476 4.29161 103.062 4.70703L102.202 6.38867C101.746 6.11504 101.15 5.90591 100.714 5.81641C100.278 5.71573 99.8524 5.66504 99.4385 5.66504C98.8343 5.66504 98.392 5.74917 98.1123 5.91699C97.8327 6.0736 97.6934 6.28085 97.6934 6.53809C97.6934 6.76186 97.7883 6.93552 97.9785 7.05859C98.1799 7.18161 98.4432 7.27664 98.7676 7.34375C99.092 7.41085 99.5412 7.4724 99.9326 7.52832C100.324 7.57308 100.716 7.64541 101.107 7.74609C101.499 7.84679 101.857 7.99242 102.182 8.18262C102.506 8.36163 102.763 8.61405 102.953 8.93848C103.154 9.2517 103.256 9.65977 103.256 10.1631C103.256 10.7225 103.088 11.2155 102.752 11.6406C102.427 12.0656 101.952 12.4014 101.325 12.6475C100.699 12.8823 99.9379 13 99.043 13C98.2823 13 97.5495 12.9104 96.8447 12.7314C96.1399 12.5412 95.58 12.3061 95.166 12.0264L96.0225 10.2305C96.4364 10.4877 96.9231 10.7004 97.4824 10.8682C98.0528 11.0247 98.6121 11.1035 99.1602 11.1035C99.7755 11.1035 100.212 11.0248 100.47 10.8682C100.738 10.7115 100.872 10.4989 100.872 10.2305C100.872 10.018 100.772 9.85602 100.57 9.74414C100.38 9.62107 100.122 9.53153 99.7979 9.47559C99.4734 9.41966 99.0243 9.36355 98.6328 9.30762C98.2412 9.25168 97.8496 9.17837 97.458 9.08887C97.0665 8.98817 96.7082 8.84252 96.3838 8.65234C96.0595 8.46216 95.796 8.21062 95.5947 7.89746C95.4046 7.57304 95.3096 7.14776 95.3096 6.62207C95.3096 6.06274 95.4725 5.56521 95.7969 5.12891C96.1325 4.69262 96.6074 4.35605 97.2227 4.12109C97.838 3.87495 98.5716 3.75195 99.4219 3.75195ZM108.834 3.75195C109.74 3.75199 110.54 3.95156 111.234 4.35156C111.928 4.7398 112.469 5.28151 112.857 5.97559C113.246 6.66977 113.44 7.47 113.44 8.37598C113.44 9.28191 113.246 10.0822 112.857 10.7764C112.469 11.4702 111.928 12.017 111.234 12.417C110.552 12.8053 109.763 13 108.869 13C107.975 13 107.175 12.8053 106.469 12.417C105.775 12.017 105.227 11.4704 104.827 10.7764C104.439 10.0822 104.245 9.28191 104.245 8.37598C104.245 7.47005 104.439 6.66975 104.827 5.97559C105.215 5.2814 105.757 4.73984 106.451 4.35156C107.145 3.95159 107.94 3.75195 108.834 3.75195ZM127.244 3.75195C128.021 3.75195 128.733 3.95747 129.38 4.36914C130.039 4.76918 130.563 5.36403 130.951 6.15234C131.351 6.92873 131.551 7.87575 131.551 8.99316H125.084C125.113 9.34191 125.215 9.65374 125.392 9.92871C125.615 10.2463 125.897 10.4934 126.238 10.6699C126.591 10.8346 126.968 10.917 127.368 10.917C127.851 10.917 128.245 10.8172 128.551 10.6172C128.857 10.4054 129.092 10.135 129.257 9.80566L131.339 10.6172C131.092 11.1113 130.768 11.5405 130.368 11.9053C129.98 12.2583 129.515 12.5295 128.974 12.7178C128.433 12.9059 127.815 13 127.121 13C126.25 13 125.479 12.8053 124.809 12.417C124.138 12.017 123.609 11.4703 123.221 10.7764C122.844 10.0822 122.656 9.28191 122.656 8.37598C122.656 7.47 122.85 6.66977 123.238 5.97559C123.638 5.28142 124.18 4.73983 124.862 4.35156C125.556 3.95175 126.35 3.75201 127.244 3.75195ZM18.4463 6.1875C17.9051 6.18752 17.3935 6.25243 16.9111 6.38184C16.4405 6.51125 16.0578 6.7225 15.7637 7.0166C15.4695 7.31075 15.3223 7.68762 15.3223 8.14648V12.7881H12.9932V3.96387H15.3223V5.56152C15.6745 5.04733 16.1047 4.65654 16.6113 4.3877C17.1995 4.08184 17.811 3.92874 18.4463 3.92871V6.1875ZM61.6777 6.1875C61.1366 6.18753 60.6249 6.25244 60.1426 6.38184C59.672 6.51126 59.2892 6.72248 58.9951 7.0166C58.7377 7.27403 58.5937 7.59493 58.5615 7.97852L58.5547 8.14648V12.7881H56.2246V3.96387H58.5547V5.56055C58.9067 5.04688 59.3365 4.65636 59.8428 4.3877C60.431 4.08184 61.0425 3.92877 61.6777 3.92871V6.1875ZM90.6602 3.75195C91.3543 3.75195 91.9482 3.89344 92.4424 4.17578C92.9365 4.45815 93.3134 4.899 93.5723 5.49902C93.8311 6.08732 93.9551 6.85267 93.9434 7.79395V12.7881H91.6133V8.26953C91.6132 7.6698 91.5425 7.20533 91.4014 6.87598C91.272 6.54664 91.0839 6.31113 90.8369 6.16992C90.5898 6.01697 90.3011 5.94043 89.9717 5.94043C89.3717 5.92871 88.9066 6.11084 88.5771 6.4873C88.2993 6.81672 88.1432 7.28598 88.1084 7.89453L88.1016 8.16406V12.7881H85.7715V3.96387H87.96L88.0635 5.15332C88.2958 4.7951 88.5729 4.50404 88.8955 4.28125C89.4014 3.92836 89.9896 3.75196 90.6602 3.75195ZM119.331 10.8008H122.062V12.7881H114.043V10.8008H116.773V1.9873H114.043V0H119.331V10.8008ZM33.6113 5.83398C33.1447 5.83398 32.7331 5.94402 32.377 6.16504C32.0208 6.37381 31.7381 6.67538 31.5293 7.06836C31.333 7.44896 31.2354 7.88494 31.2354 8.37598C31.2354 8.87935 31.3329 9.32152 31.5293 9.70215C31.738 10.0828 32.0209 10.3835 32.377 10.6045C32.7331 10.8133 33.1447 10.918 33.6113 10.918C34.3236 10.918 34.8944 10.6844 35.3242 10.2178C35.7663 9.73885 35.9873 9.12506 35.9873 8.37598C35.9873 7.87247 35.8889 7.4305 35.6924 7.0498C35.4959 6.66916 35.2203 6.3738 34.8643 6.16504C34.5081 5.94399 34.0903 5.83399 33.6113 5.83398ZM50.4492 5.90527C50.0259 5.90533 49.6438 6.01105 49.3027 6.22266C48.9733 6.43444 48.7136 6.72896 48.5254 7.10547C48.3373 7.47012 48.2432 7.89374 48.2432 8.37598C48.2432 8.8582 48.3373 9.28765 48.5254 9.66406C48.7136 10.0288 48.9791 10.3175 49.3203 10.5293C49.6615 10.741 50.0501 10.8467 50.4854 10.8467C50.9204 10.8466 51.3026 10.7409 51.6318 10.5293C51.9613 10.3175 52.2141 10.0288 52.3906 9.66406C52.5789 9.28758 52.6728 8.85833 52.6729 8.37598C52.6729 7.8936 52.5789 7.4702 52.3906 7.10547C52.2024 6.72896 51.9379 6.43444 51.5967 6.22266C51.2673 6.01092 50.8845 5.90527 50.4492 5.90527ZM79.9961 5.90527C79.5728 5.90533 79.1907 6.01104 78.8496 6.22266C78.5202 6.43444 78.2605 6.72896 78.0723 7.10547C77.8842 7.47012 77.79 7.89376 77.79 8.37598C77.7901 8.8582 77.8841 9.28766 78.0723 9.66406C78.2605 10.0288 78.526 10.3175 78.8672 10.5293C79.2082 10.7409 79.5962 10.8466 80.0312 10.8467C80.4665 10.8467 80.8493 10.741 81.1787 10.5293C81.5082 10.3175 81.761 10.0288 81.9375 9.66406C82.1257 9.28759 82.2197 8.85833 82.2197 8.37598C82.2197 7.89363 82.1257 7.47018 81.9375 7.10547C81.7492 6.72896 81.4848 6.43444 81.1436 6.22266C80.8141 6.0109 80.4314 5.90527 79.9961 5.90527ZM108.834 5.90527C108.41 5.90527 108.028 6.01087 107.687 6.22266C107.357 6.43444 107.098 6.72896 106.91 7.10547C106.722 7.47017 106.628 7.89366 106.628 8.37598C106.628 8.8583 106.722 9.2876 106.91 9.66406C107.098 10.0288 107.363 10.3175 107.704 10.5293C108.045 10.7411 108.434 10.8467 108.869 10.8467C109.304 10.8467 109.687 10.7411 110.017 10.5293C110.346 10.3175 110.599 10.0288 110.775 9.66406C110.964 9.28764 111.058 8.85823 111.058 8.37598C111.058 7.89373 110.964 7.47013 110.775 7.10547C110.587 6.72896 110.322 6.43444 109.98 6.22266C109.651 6.01106 109.269 5.90531 108.834 5.90527ZM23.7217 5.72852C23.4512 5.72855 23.1632 5.7877 22.8574 5.90527C22.5515 6.02293 22.2861 6.21088 22.0625 6.46973C21.8875 6.67397 21.7862 6.93886 21.7559 7.26367H25.582C25.5534 6.93886 25.4583 6.67397 25.293 6.46973C25.093 6.21099 24.8457 6.02294 24.5518 5.90527C24.2694 5.78761 23.9923 5.72852 23.7217 5.72852ZM127.174 5.72852C126.903 5.72853 126.615 5.7877 126.31 5.90527C126.004 6.02293 125.738 6.21088 125.515 6.46973C125.34 6.67398 125.238 6.93883 125.208 7.26367H129.034C129.006 6.93887 128.91 6.67397 128.745 6.46973C128.545 6.21102 128.298 6.02294 128.004 5.90527C127.722 5.78761 127.444 5.72852 127.174 5.72852Z"
                fill="white"
                fill-opacity="0.6"
            />
        </svg>
    );
}
